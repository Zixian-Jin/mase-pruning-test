Script started on 2024-07-29 08:45:54+01:00 [TERM="xterm" TTY="/dev/pts/6" COLUMNS="158" LINES="48"]
]0;cj323@ee-kraken:~/mase-pruning-test[?2004h[cj323@ee-kraken mase-pruning-test]$ conda acitvate mase
[?2004l
CommandNotFoundError: No command 'conda acitvate'.
Did you mean 'conda activate'?

]0;cj323@ee-kraken:~/mase-pruning-test[?2004h[cj323@ee-kraken mase-pruning-test]$ conda activate mase
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ python bert_inference.py 
[?2004lA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
A parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.
A parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.
INFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth
Pruing Configuraitons:
Block_num= 64
Layers to prune= [1, 3, 5, 7, 9]
Weights to prune= ['V']
========== Prune after training ===========
INFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth
Sparsity=0.500000
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
Before pruning: acc=87.39583333333333. After pruning: acc=88.95833333333333.
========== Prune after training ===========
INFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth
Sparsity=0.600000
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...

INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
Before pruning: acc=87.39583333333333. After pruning: acc=87.91666666666667.
========== Prune after training ===========
INFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth
Sparsity=0.700000
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
Before pruning: acc=87.39583333333333. After pruning: acc=86.45833333333333.
========== Prune after training ===========
INFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth
Sparsity=0.800000
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
INFO: Pruning...
INFO: Finished pruning.
Before pruning: acc=87.39583333333333. After pruning: acc=85.72916666666667.
]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 86.46
[?2004lbash: 86.46: command not found
]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ n[Kls
[?2004lbert_inference.py  layer_0to11_K.log    layer_13579_V.log  [0m[01;34mmodels[0m             README.md         template.py      utils.py
[01;34mckpts[0m              layer_0to11_V.log    layer_1to11_Q.log  [01;34m__pycache__[0m        [01;34mrefs[0m              testbench.ipynb
[01;34mdatasets[0m           layer_13579_QKV.log  [01;34mlogs[0m               rank_functions.py  requirements.txt  TODO
]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ nano layer_13579_QKC[KV.log 
[?2004l[?2004h[?1049h[22;0;0t[1;48r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[46;73H(B[0;7m[ Reading... ](B[m[46;71H(B[0;7m[ Read 203 lines ](B[m[H(B[0;7m  GNU nano 5.6.1                                                        layer_13579_QKV.log                                                                   [1;157H(B[m[47d(B[0;7m^G(B[m Help[47;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is	   (B[0;7m^K(B[m Cut[47;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[47;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket[48d(B[0;7m^X(B[m Exit[48;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace	   (B[0;7m^U(B[m Paste[48;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^_(B[m Go To Line    (B[0;7mM-E(B[m Redo[48;120H(B[0;7mM-6(B[m Copy[48;137H(B[0;7m^Q(B[m Where Was[2dScript started on 2024-07-29 08:42:02+01:00 [TERM="screen" TTY="/dev/pts/41" COLUMNS="120" LINES="47"][3d^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h[cj323@ee-kraken mase-pruning-test]$ onda activate ^C^[(B[m[?2004l^M^[(B[m[?2004h^[(B[m[?2004l^M[4d^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h[cj323@ee-kraken mase-pruning-test]$ conda activate mase[5d^[(B[m[?2004l^M^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ python bert_inference.py[6d^[(B[m[?2004l^M(B[mA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[7dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[8dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[9dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[10dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[11dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[12dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[13dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[14dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[15dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[16dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[17dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[18dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[19dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[20dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[21dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[22dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[23dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[24dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[25dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[26dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[27dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[28dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[29dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[30dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[31dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[32dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[33dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[34dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[35dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[36dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[37dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[38dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[39dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[40dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[41dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[42dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[43dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[44dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[45dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[2d[?12l[?25h[?25l[3d[?12l[?25h[?25l[4d[?12l[?25h[?25l[5d[?12l[?25h[?25l[6d[?12l[?25h[?25l[7d[?12l[?25h[?25l[8d[?12l[?25h[?25l[9d[?12l[?25h[?25l[10d[?12l[?25h[?25l[11d[?12l[?25h[?25l[12d[?12l[?25h[?25l[13d[?12l[?25h[?25l[14d[?12l[?25h[?25l[15d[?12l[?25h[?25l[16d[?12l[?25h[?25l[17d[?12l[?25h[?25l[18d[?12l[?25h[?25l[19d[?12l[?25h[?25l[20d[?12l[?25h[?25l[21d[?12l[?25h[?25l[46d[K[22d[?12l[?25h[?25l[23d[?12l[?25h[?25l[47;18H[14X[47;32H(B[0;7mM-C(B[m Case Sens 	              (B[0;7mM-B(B[m Backwards   [86G        (B[0;7m^P(B[m Older         [47;120H     (B[0;7m^T(B[m Go To Line[K[48;2H(B[0;7mC(B[m Cancel[48;18H[14X[48;32H(B[0;7mM-R(B[m Reg.exp. 	              (B[0;7m^R(B[m Replace      [86G        (B[0;7m^N(B[m Newer[K[47;138H[A(B[0;7mSearch:                                                                                                                                                       [46;9H(B[m[?12l[?25h[?25l(B[0;7mA(B[m[?12l[?25h[?25l(B[0;7mf(B[m[?12l[?25h[?25l(B[0;7mt(B[m[?12l[?25h[?25l(B[0;7me(B[m[?12l[?25h[?25l(B[0;7mr(B[m[?12l[?25h[?25l[C[?12l[?25h[?25l(B[0;7mp(B[m[?12l[?25h[?25l(B[0;7mr(B[m[?12l[?25h[?25l(B[0;7mu(B[m[?12l[?25h[?25l(B[0;7mn(B[m[?12l[?25h[?25l(B[0;7mi(B[m[?12l[?25h[?25l(B[0;7mn(B[m[?12l[?25h[?25l(B[0;7mg(B[m[?12l[?25h[?25l[K[47;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is	   (B[0;7m^K(B[m Cut           (B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location      (B[0;7mM-U(B[m Undo[47;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket[48;2H(B[0;7mX(B[m Exit  [48;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace	   (B[0;7m^U(B[m Paste         (B[0;7m^J(B[m Justify[86G(B[0;7m^_(B[m Go To Line    (B[0;7mM-E(B[m Redo[48;120H(B[0;7mM-6(B[m Copy[48;137H(B[0;7m^Q(B[m Where Was[2dINFO: Pruning...[K[3dINFO: Finished pruning.[K[4dINFO: Pruning...[K[5dINFO: Finished pruning.[K[6dINFO: Pruning...[K[7dINFO: Finished pruning.[K[8dINFO: Pruning...[K[9dINFO: Finished pruning.[K[10dINFO: Pruning...[K[11dINFO: Finished pruning.[K[12dINFO: Pruning...[K[13dINFO: Finished pruning.[K[14dINFO: Pruning...[K[15dINFO: Finished pruning.[K[16dINFO: Pruning...[K[17dINFO: Finished pruning.[K[18dINFO: Pruning...[K[19dINFO: Finished pruning.[K[20dINFO: Pruning...[K[21dINFO: Finished pruning.[K[22dINFO: Pruning...[K[23dINFO: Finished pruning.[K[24dBefore pruning: acc=87.5. [30m[43mAfter pruning[39;49m(B[m: acc=87.39583333333333.[K[25d========== Prune after training ===========[K[26dINFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth[K[27dSparsity=0.600000[K[28dINFO: Pruning...[K[29dINFO: Finished pruning.[K[30dINFO: Pruning...[K[31dINFO: Finished pruning.[K[32dINFO: Pruning...[K[33dINFO: Finished pruning.[K[34dINFO: Pruning...[K[35dINFO: Finished pruning.[K[36dINFO: Pruning...[K[37dINFO: Finished pruning.[K[38dINFO: Pruning...[K[39d[K[40dINFO: Finished pruning.[K[41dINFO: Pruning...[K[42dINFO: Finished pruning.[K[43dINFO: Pruning...[K[44dINFO: Finished pruning.[K[45dINFO: Pruning...[K[24;27HAfter pruning[25;27H[?12l[?25h[?25l[26d[?12l[?25h[?25l[27;18H[?12l[?25h[?25l[28;17H[?12l[?25h[?25l[29;24H[?12l[?25h[?25l[30;17H[?12l[?25h[?25l[31;24H[?12l[?25h[?25l[32;17H[?12l[?25h[?25l[33;24H[?12l[?25h[?25l[34;17H[?12l[?25h[?25l[35;24H[?12l[?25h[?25l[36;17H[?12l[?25h[?25l[37;24H[?12l[?25h[?25l[38;17H[?12l[?25h[?25l[39d[?12l[?25h[?25l[40;24H[?12l[?25h[?25l[41;17H[?12l[?25h[?25l[42;24H[?12l[?25h[?25l[43;17H[?12l[?25h[?25l[44;24H[?12l[?25h[?25l[45;17H[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HBefore pruning: acc=87.5. After pruning: acc=87.08333333333333.[45;27H[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1H========== Prune after training ===========[45;27H[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth[45;27H[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HSparsity=0.700000[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d
[1;48r[45;1HINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HBefore pruning: acc=87.5. After pruning: acc=82.91666666666667.[44d========== Prune after training ===========[45dINFO: loaded downstream model from ./ckpts/downstream_model_unpruned.pth[45;27H[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HSparsity=0.800000[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dINFO: Pruning...[45dINFO: Finished pruning.[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Pruning...[44dINFO: Finished pruning.[45dINFO: Pruning...[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1HINFO: Finished pruning.[44dBefore pruning: acc=87.5. After pruning: acc=83.75.[45d^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$[45;27H[?12l[?25h[?25l7[2;46r8[46d[3S[1;48r[43;1H^[(B[m[?2004l^M^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ x^H^[(B[m[Kexit[44d^[(B[m[?2004l^M(B[mexit[45d[?12l[?25h[?25l7[2;46r8[46d[2S[1;48r[44;1HScript done on 2024-07-29 08:57:20+01:00 [COMMAND_EXIT_CODE="0"][45d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[47d[J[48d[?12l[?25h[48;1H[?1049l[23;0;0t[?1l>[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ nano bert_inference.py 
[?2004l[?2004h[?1049h[22;0;0t[1;48r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[46;73H(B[0;7m[ Reading... ](B[m[46;71H(B[0;7m[ Read 252 lines ](B[m[H(B[0;7m  GNU nano 5.6.1                                                         bert_inference.py                                                                    [1;157H(B[m[47d(B[0;7m^G(B[m Help[47;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is	   (B[0;7m^K(B[m Cut[47;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[47;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket[48d(B[0;7m^X(B[m Exit[48;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace	   (B[0;7m^U(B[m Paste[48;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^_(B[m Go To Line    (B[0;7mM-E(B[m Redo[48;120H(B[0;7mM-6(B[m Copy[48;137H(B[0;7m^Q(B[m Where Was[2d(B[0;1m[36mimport[39m(B[m torch[3d(B[0;1m[36mimport[39m(B[m numpy (B[0;1m[36mas[39m(B[m np[4d(B[0;1m[36mfrom[39m(B[m datasets (B[0;1m[36mimport[39m(B[m load_dataset[5d(B[0;1m[36mfrom[39m(B[m transformers (B[0;1m[36mimport[39m(B[m BertTokenizer, BertModel, AdamW[6d(B[0;1m[36mfrom[39m(B[m torch.utils.data (B[0;1m[36mimport[39m(B[m DataLoader, Dataset[8d(B[0;1m[36mimport[39m(B[m utils[9d(B[0;1m[36mimport[39m(B[m rank_functions[11d(B[0;1m[36mclass[39m(B[m BertDataset(Dataset):[12;5H(B[0;1m[36mdef[34m __init__[39m(B[m(self, split):[13;9Hself.dataset = load_dataset(path=(B[0;1m[32m'lansinuote/ChnSentiCorp'[39m(B[m, split=split)[15;5H(B[0;1m[36mdef[34m __len__[39m(B[m(self):[16;9H(B[0;1m[36mreturn[39m(B[m len(self.dataset)[18;5H(B[0;1m[36mdef[34m __getitem__[39m(B[m(self, i):[19;9Htext = self.dataset[i][(B[0;1m[32m'text'[39m(B[m][20;9Hlabel = self.dataset[i][(B[0;1m[32m'label'[39m(B[m][21;9H(B[0;1m[36mreturn[39m(B[m text, label[24d[42m    [25d(B[0;1m[31m# print(len(loader))[26d# input_ids.shape, attention_mask.shape, token_type_ids.shape, labels[27d#æ¨¡åž‹è¯•ç®—[28d# out = pretrained(input_ids=input_ids,[29d#            attention_mask=attention_mask,[30d#            token_type_ids=token_type_ids)[31d# out.last_hidden_state.shape[38d[36mclass[39m(B[m DownstreamModel(torch.nn.Module):[39;5H(B[0;1m[36mdef[34m __init__[39m(B[m(self):[40;9Hsuper().__init__()[41;8H(B[0;1m[31m # print(len(dataset), dataset[0])[42;9H[39m(B[mself.tokenizer = BertTokenizer.from_pretrained((B[0;1m[32m'bert-base-chinese'[39m(B[m)[43;9Hself.pretrained = BertModel.from_pretrained((B[0;1m[32m'bert-base-chinese'[39m(B[m)[44;9Hself.pretrained.to(device)(B[0;1m[31m # [37m[43mTODO[45;12H[39;49m[31m # pretrained = BertModel.from_pretrained('tmp')  # local checkpoint[2d[39m(B[m[?12l[?25h[?25l[47;18H[14X[47;32H(B[0;7mM-C(B[m Case Sens 	              (B[0;7mM-B(B[m Backwards   [86G        (B[0;7m^P(B[m Older         [47;120H     (B[0;7m^T(B[m Go To Line[K[48;2H(B[0;7mC(B[m Cancel[48;18H[14X[48;32H(B[0;7mM-R(B[m Reg.exp. 	              (B[0;7m^R(B[m Replace      [86G        (B[0;7m^N(B[m Newer[K[47;138H[A(B[0;7mSearch:                                                                                                                                                       [46;9H(B[m[?12l[?25h[?25l(B[0;7ml(B[m[?12l[?25h[?25l(B[0;7ma(B[m[?12l[?25h[?25l(B[0;7my(B[m[?12l[?25h[?25l(B[0;7me(B[m[?12l[?25h[?25l(B[0;7mr(B[m[?12l[?25h[?25l(B[0;7ms(B[m[?12l[?25h[?25l(B[0;7m_(B[m[?12l[?25h[?25l(B[0;7mt(B[m[?12l[?25h[?25l(B[0;7mo(B[m[?12l[?25h[?25l[?12l[?25h[?25l[K[47;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is	   (B[0;7m^K(B[m Cut           (B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location      (B[0;7mM-U(B[m Undo[47;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket[48;2H(B[0;7mX(B[m Exit  [48;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace	   (B[0;7m^U(B[m Paste         (B[0;7m^J(B[m Justify[86G(B[0;7m^_(B[m Go To Line    (B[0;7mM-E(B[m Redo[48;120H(B[0;7mM-6(B[m Copy[48;137H(B[0;7m^Q(B[m Where Was[2;8H[1K	(B[0;1m[36mfor[39m(B[m module (B[0;1m[36min[39m(B[m modules_to_prune:[3;12H[1K self.structured_prune(module)[4d[K[5d[K[6d(B[0;1m[36mif[39m(B[m __name__ == (B[0;1m[32m'__main__'[39m(B[m:[K[7;5Hdevice = (B[0;1m[32m'cuda'[39m(B[m (B[0;1m[36mif[39m(B[m torch.cuda.is_available() (B[0;1m[36melse[39m(B[m (B[0;1m[32m'cpu'[31m # [37m[43mTODO[8d[39;49m(B[m    prune_config = {[9;12H[1K (B[0;1m[32m"module"[39m(B[m: (B[0;1m[35mNone[39m(B[m,[10;13H(B[0;1m[32m"scope"[39m(B[m: (B[0;1m[32m"local"[39m(B[m,[11;12H[1K (B[0;1m[32m"block_num"[39m(B[m: 64,[12;12H[1K (B[0;1m[32m"sparsity"[39m(B[m: 0.5[K[13;5H}[K[14dmodel = DownstreamModel()[15;5Hmodel.to(device)[K[16;4H(B[0;1m[31m # prune_config['module'] = "fc1"[17;5H[39m(B[mmodule = model.pretrained.encoder.layer._modules[(B[0;1m[32m'0'[39m(B[m].attention.self.query.weight.detach()[18;4H(B[0;1m[31m # model.downstream_train()[19d(B[0m[42m    [49m(B[m[K[20dmodel.load_downstream_model()[K[21;4H(B[0;1m[31m # model.check_sparsity(module=model.fc1)[22;5H[39m(B[macc_1 = model.downstream_test()[23d[42m    [24d[49m(B[m    [30m[43mlayers_to[39;49m(B[m_prune = [1, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[25d[39m(B[m    weights_to_prune = [(B[0;1m[32m'V'[39m(B[m](B[0;1m[31m #, 'K', 'V'][26d(B[0m[42m    [49m(B[m[K[27d    print((B[0;1m[32m'Pruing Configuraitons:'[39m(B[m)[28d    print((B[0;1m[32m'Block_num='[39m(B[m, prune_config[(B[0;1m[32m'block_num'[39m(B[m])[29d    print((B[0;1m[32m'Layers to prune='[39m(B[m, layers_to_prune)[30d    print((B[0;1m[32m'Weights to prune='[39m(B[m, weights_to_prune)[31d    (B[0;1m[36mfor[39m(B[m i (B[0;1m[36min[39m(B[m [0.5, 0.6, 0.7, 0.8]:(B[0;1m[31m # 0.9, 0.92, 0.95, 0.98, 1.00]:[32;4H # for i in [0.9, 0.95, 0.98, 1.00]:[33;9H[39m(B[mprint((B[0;1m[32m'========== Prune after training ==========='[39m(B[m)[34;9Hmodel.load_downstream_model()[35;9Hprint((B[0;1m[32m"Sparsity=%f"[39m(B[m%i)[36;9Hprune_config = {[37;13H(B[0;1m[32m"module"[39m(B[m: (B[0;1m[32m'fc1'[39m(B[m,[38;12H[1K (B[0;1m[32m"scope"[39m(B[m: (B[0;1m[32m"local"[39m(B[m,[K[39;12H[1K (B[0;1m[32m"block_num"[39m(B[m: 64,[40;9H    (B[0;1m[32m"sparsity"[39m(B[m: i[K[41;8H }[K[42;8H(B[0;1m[31m # model.structured_prune(module=model.fc1)[39m(B[m[K[43;9Hmodel.bert_attention_prune(layers_to_prune, weights_to_prune)[K[44;9Hacc_2 = model.downstream_test()[K[45;9Hprint(f(B[0;1m[32m"Before pruning: acc={acc_1}. After pruning: acc={acc_2}."[39m(B[m)[K[24;5Hlayers_to[25;5H[?12l[?25h[?25l[26d[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[24d[?12l[?25h[?25ll[?12l[?25h[?25la[?12l[?25h[?25ly[?12l[?25h[?25l	[?12l[?25h[?25lr[?12l[?25h[?25ls[?12l[?25h[?25l_[?12l[?25h[?25lt[?12l[?25h[?25lo[?12l[?25h[?25l_[?12l[?25h[?25lp[?12l[?25h[?25l	[?12l[?25h[?25lu[?12l[?25h[?25ln[?12l[?25h[?25le[?12l[?25h[?25l [?12l[?25h[?25l=[?12l[?25h[?25l [?12l[?25h[?25l[[?12l[?25h[?25l	[?12l[?25h[?25l,[?12l[?25h[?25l [?12l[?25h[?25l3[?12l[?25h[?25l,[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[Z[?12l[?25h[?25l[1;149H(B[0;7mModified(B[m[24;24H[1P[?12l[?25h[?25l0, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;25H[39m(B[m[?12l[?25h[?25l , 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;26H[39m(B[m[?12l[?25h[?25l,, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;27H[39m(B[m[?12l[?25h[?25l2, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;28H[39m(B[m[?12l[?25h[?25l , 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;29H[39m(B[m[?12l[?25h[?25l4, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;30H[39m(B[m[?12l[?25h[?25l,, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;31H[39m(B[m[?12l[?25h[?25l , 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;32H[39m(B[m[?12l[?25h[?25l6, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;33H[39m(B[m[?12l[?25h[?25l,, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;34H[39m(B[m[?12l[?25h[?25l , 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;35H[39m(B[m[?12l[?25h[?25l8, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;36H[39m(B[m[?12l[?25h[?25l,, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;37H[39m(B[m[?12l[?25h[?25l , 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;38H[39m(B[m[?12l[?25h[?25l1, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;39H[39m(B[m[?12l[?25h[?25l0, 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;40H[39m(B[m[?12l[?25h[?25l], 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;41H[39m(B[m[?12l[?25h[?25l,[?12l[?25h[?25l[Z[1P[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[Z[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l,[?12l[?25h[?25l[1P[?12l[?25h[?25l[Z[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l	[?12l[?25h[?25l, 4, 6, 8, 10] 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;26H[39m(B[m[?12l[?25h[?25l  4, 6, 8, 10] 3, 5, 7, 9](B[0;1m[31m # list(range(12))[24;27H[39m(B[m[?12l[?25h[?25l [?12l[?25h[?25l[1P [?12l[?25h[?25l4[?12l[?25h[?25l,[?12l[?25h[?25l [?12l[?25h[?25l6[?12l[?25h[?25l,[?12l[?25h[?25l	[?12l[?25h[?25l8[?12l[?25h[?25l,[?12l[?25h[?25l [?12l[?25h[?25l1[?12l[?25h[?25l0[?12l[?25h[?25l][?12l[?25h[?25l [?12l[?25h[?25l	[?12l[?25h[?25l,[?12l[?25h[?25l [?12l[?25h[?25l5[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[Z[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l[25d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[Z[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[C[?12l[?25h[?25l , (B[0;1m[32m'K'[39m(B[m, (B[0;1m[32m'V'[39m(B[m][K[25;30H[?12l[?25h[?25l[1P[?12l[?25h[?25l[1P[?12l[?25h[?25l(B[0;1m[32m, '[39m(B[mK(B[0;1m[32m', '[39m(B[mV'][K[25;27H[?12l[?25h[?25l[1P[?12l[?25h[?25l[Z, (B[0;1m[32m'K'[39m(B[m, (B[0;1m[32m'V'[39m(B[m][K[25;25H[?12l[?25h[?25lQ, (B[0;1m[32m'K'[39m(B[m, (B[0;1m[32m'V'[39m(B[m][25;26H[?12l[?25h[?25l[Z[1P[?12l[?25h[?25l(B[0;1m[32m', '[39m(B[mK(B[0;1m[32m', '[39m(B[mV'][25;26H[?12l[?25h[?25l(B[0;1m[32mâ€˜, '[39m(B[mK(B[0;1m[32m', '[39m(B[mV'][25;27H[?12l[?25h[?25l[1P[?12l[?25h[?25l[Z, (B[0;1m[32m'K'[39m(B[m, (B[0;1m[32m'V'[39m(B[m][K[25;25H[?12l[?25h[?25l(B[0;1m[32m', '[39m(B[mK(B[0;1m[32m', '[39m(B[mV'][25;26H[?12l[?25h[?25l(B[0;1m[32mQ, '[39m(B[mK(B[0;1m[32m', '[39m(B[mV'][25;27H[?12l[?25h[?25l(B[0;1m[32m'[39m(B[m, (B[0;1m[32m'K'[39m(B[m, (B[0;1m[32m'V'[39m(B[m][25;28H[?12l[?25h[?25l,[?12l[?25h[?25l [?12l[?25h[?25l[C[?12l[?25h[?25l[C[?12l[?25h[?25l	[?12l[?25h[?25l,[?12l[?25h[?25l [?12l[?25h[?25l[C[?12l[?25h[?25l[C[?12l[?25h[?25l[C[?12l[?25h[?25l][?12l[?25h[?25l[26d[?12l[?25h[?25l[C[?12l[?25h[?25l[C[?12l[?25h[?25l[C[?12l[?25h[?25l[C[?12l[?25h[?25l[27d[?12l[?25h[?25l[46d(B[0;7mSave modified buffer?                                                                                                                                         [47;1H Y(B[m Yes[K[48d(B[0;7m N(B[m No  [48;17H(B[0;7m^C(B[m Cancel[K[46;23H[?12l[?25h[?25l[47d(B[0;7m^G(B[m Help[47;40H(B[0;7mM-D(B[m DOS Format[47;79H(B[0;7mM-A(B[m Append[47;118H(B[0;7mM-B(B[m Backup File[48d(B[0;7m^C(B[m Cancel	         [48;40H(B[0;7mM-M(B[m Mac Format[48;79H(B[0;7mM-P(B[m Prepend[48;118H(B[0;7m^T(B[m Browse[46d(B[0;7mFile Name to Write: bert_inference.py(B[m[?12l[?25h[?25l[46;72H[1K	(B[0;7m[ Writing... ](B[m[K[1;149H(B[0;7m        (B[m[46;70H(B[0;7m[ Wrote 252 lines ](B[m[J[48d[?12l[?25h[48;1H[?1049l[23;0;0t[?1l>[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ 
[?2004l]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ ls
[?2004lbert_inference.py  layer_0to11_K.log    layer_13579_V.log     [0m[01;34mlogs[0m         rank_functions.py  requirements.txt  TODO
[01;34mckpts[0m              layer_0to11_V.log    layer_1to11_Q.log     [01;34mmodels[0m       README.md          template.py       utils.py
[01;34mdatasets[0m           layer_13579_QKV.log  layer_246810_QKV.log  [01;34m__pycache__[0m  [01;34mrefs[0m               testbench.ipynb
]0;cj323@ee-kraken:~/mase-pruning-test[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ nano layer_246810_QKV.log 
[?2004l[?2004h[?1049h[22;0;0t[1;48r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[46;73H(B[0;7m[ Reading... ](B[m[46;71H(B[0;7m[ Read 206 lines ](B[m[H(B[0;7m  GNU nano 5.6.1                                                        layer_246810_QKV.log                                                                  [1;157H(B[m[47d(B[0;7m^G(B[m Help[47;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is	   (B[0;7m^K(B[m Cut[47;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[47;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket[48d(B[0;7m^X(B[m Exit[48;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace	   (B[0;7m^U(B[m Paste[48;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^_(B[m Go To Line    (B[0;7mM-E(B[m Redo[48;120H(B[0;7mM-6(B[m Copy[48;137H(B[0;7m^Q(B[m Where Was[2dScript started on 2024-07-29 09:00:39+01:00 [TERM="screen" TTY="/dev/pts/41" COLUMNS="120" LINES="47"][3d^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h[cj323@ee-kraken mase-pruning-test]$ conda acitvate mase[4d^[(B[m[?2004l^M[5d(B[mCommandNotFoundError: No command 'conda acitvate'.[6dDid you mean 'conda activate'?[8d^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h[cj323@ee-kraken mase-pruning-test]$ a^H^[(B[m[Kconda activate mase[9d^[(B[m[?2004l^M^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ pytohn bert_inference.py ===========================(B[0;7m>[10;1H(B[0m^[(B[mkcj323@ee-kraken:~/mase-pruning-test^[(B[m\^[(B[m[?2004h(mase) [cj323@ee-kraken mase-pruning-test]$ python bert_inference.py[11d^[(B[m[?2004l^M(B[mA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[12dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[13dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[14dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[15dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[16dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[17dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[18dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[19dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[20dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[21dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[22dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[23dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[24dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[25dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[26dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[27dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[28dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[29dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[30dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[31dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[32dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[33dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[34dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[35dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[36dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[37dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[38dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[39dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[40dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[41dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[42dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[43dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[44dA parameter name that contains `gamma` will be renamed internally to `weight`. Please use a different name to suppress this warning.[45dA parameter name that contains `beta` will be renamed internally to `bias`. Please use a different name to suppress this warning.[2d[?12l[?25h[?25l[47;18H[14X[47;32H(B[0;7mM-C(B[m Case Sens 	              (B[0;7mM-B(B[m Backwards   [86G        (B[0;7m^P(B[m Older         [47;120H     (B[0;7m^T(B[m Go To Line[K[48;2H(B[0;7mC(B[m Cancel[48;18H[14X[48;32H(B[0;7mM-R(B[m Reg.exp. 	              (B[0;7m^R(B[m Replace      [86G        (B[0;7m^N(B[m Newer[K[47;138H[A(B[0;7mSearch:                                                                                                                                                       [46;9H(B[m[?12l[?25h[?25l(B[0;7mA(B[m[?12l[?25h[?25l(B[0;7mf(B[m[?12l[?25h[?25l(B[0;7mt(B[m[?12l[?25h[?25l(B[0;7me(B[m[?12l[?25h[?25l(B[0;7mr(B[m[?12l[?25h[?25l[C[?12l[?25h[?25l(B[0;7mp(B[m[?12l[?25h[?25l(B[0;7mr(B[m[?12l[?25h[?25l(B[0;7mu(B[m[?12l[?25h[?25l(B[0;7mn(B[m[?12l[?25h[?25l(B[0;7mi(B[m[?12l[?25h[?25l(B[0;7mn(B[m[?12l[?25h[?25l(B[0;7mg(B[m[?12l[?25h[?25l[K[47;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is	   (B[0;7m^K(B[m Cut           (B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location      (B[0;7mM-U(B[m Undo[47;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket[48;2H(B[0;7mX(B[m Exit  [48;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace	   (B[0;7m^U(B[m Paste         (B[0;7m^J(B[m Justify[86G(B[0;7m^_(B[m Go To Line    (B[0;7mM-E(B[m Redo[48;120H(B[0;7mM-6(B[m Copy[48;137H(B[0;7m^Q(B[m Where Was[2dINFO: Pruning...[K[3dINFO: Finished pruning.[K[4dINFO: Pruning...[5dINFO: Finished pruning.[K[6dINFO: Pruning...[K[7dINFO: Finished pruning.[8dINFO: Pruning...[K[9dINFO: Finished pruning.[K[10dINFO: Pruning...[K[11dINFO: Finished pruning.[K[12dINFO: Pruning...[K[13dINFO: Finished pruning.[K[14dINFO: Pruning...[K[15dINFO: Finished pruning.[K[16dINFO: Pruning...[K[17dINFO: Finished pruning.[K[18dINFO: Pruning...[K[19dINFO: Finished pruning.[K[20dINFO: Pruning...[K[21dINFO: Finished pruning.[K[22dINFO: Pruning...[K[23dINFO: Finished pruning.[K[24dBefore pruning: acc=87.39583